<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>WÃ¤rmepumpen-Speicher-Kalkulator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Berechne die optimale GrÃ¶ÃŸe deines WÃ¤rmepumpen-Pufferspeichers â€“ inkl. EVU-Sperrzeiten, HeizflÃ¤chen, Warmwasser und Komfortzuschlag." />
  <style>
    /* --- THEME VARIABLES --- */
    :root {
      /* Dark Theme (Default) */
      --c-brand: #1d6fe9;
      --c-brand-hover: #2b7aff;
      --brand: var(--c-brand);
      --c-text: #e5e7eb;
      --c-text-muted: #94a3b8;
      --c-text-header: #bfdbfe;
      --c-bg: #0b1220;
      --c-bg-panel: linear-gradient(180deg,#0e1a33 0%, #0b1220 100%);
      --c-bg-input: #0a162e;
      --c-bg-stat: #0c1830;
      --c-border: #1f2a44;
      --c-border-input: #233053;
      --c-border-stat: #21335b;
      --c-border-active: #2b67d3;
      --c-shadow: 0 8px 24px rgba(2,8,23,.45);
      --c-ring: rgba(24,102,196,.45);
      --c-thumb: conic-gradient(from 0deg,#3b82f6,#2563eb,#1e40af);
      --c-gauge-bg: #132447;
      --c-gauge-border: #28416f;
      --c-gauge-tick: #374b77;
    }

    html.light-mode {
      /* Light Theme */
      --c-brand: #1e70bf;
      --c-brand-hover: #165c9e;
      --brand: var(--c-brand);
      --c-text: #0f172a;
      --c-text-muted: #5b677a;
      --c-text-header: #1e70bf;
      --c-bg: #f6f9fc;
      --c-bg-panel: #ffffff;
      --c-bg-input: #ffffff;
      --c-bg-stat: #f9fbfe;
      --c-border: #e7edf5;
      --c-border-input: #d1d5db;
      --c-border-stat: #e9f1fb;
      --c-border-active: #1e70bf;
      --c-shadow: 0 6px 18px rgba(20,41,66,.08);
      --c-ring: rgba(30,112,191,.18);
      --c-thumb: var(--c-brand);
      --c-gauge-bg: #eaf2fb;
      --c-gauge-border: #d7e6f9;
      --c-gauge-tick: #c4d8f2;
    }

    /* --- BASE & LAYOUT --- */
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background: var(--c-bg); color: var(--c-text); line-height:1.55;
      transition: background-color .2s ease, color .2s ease;
    }
    header{max-width:1080px;margin:28px auto 8px;padding:0 18px}
    h1{font-size:1.9rem;margin:4px 0 8px}
    p.kicker{color: var(--c-text-header);letter-spacing:.06em;text-transform:uppercase;font-weight:700;margin:0 0 10px;font-size:.9rem}
    main{max-width:1080px;margin:0 auto;padding:8px 18px 60px;display:grid;grid-template-columns:1.1fr .9fr;gap:22px}

    /* --- RESPONSIVE FIXES --- */
    @media (max-width:980px){ 
        main{grid-template-columns:1fr} 
        .row{grid-template-columns:1fr}
    }

    /* --- COMPONENTS --- */
    .panel{
      background: var(--c-bg-panel);
      border:1px solid var(--c-border); border-radius:14px; padding:16px;
      box-shadow: var(--c-shadow);
    }
    .panel h2{font-size:1.15rem;margin:0 0 12px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .field{margin:10px 0}
    .label{display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:6px; justify-content: space-between;}
    .help{color: var(--c-text-muted);font-size:.88rem;margin-top:4px}
    select, input[type="number"], input[type="text"]{
      width:100%; background: var(--c-bg-input); color: var(--c-text); border:1px solid var(--c-border-input);
      border-radius:10px; padding:10px 12px; outline:none;
      transition: border-color .12s ease, box-shadow .12s ease;
    }
    select:focus, input:focus{border-color: var(--c-border-active); box-shadow:0 0 0 4px var(--c-ring)}

    /* System & Emitter Cards */
    .card-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:8px 0 6px}
    .card-btn{
      position:relative; cursor:pointer; user-select:none;
      background: var(--c-bg-input); border:1px solid var(--c-border-input); border-radius:14px; padding:14px;
      display:flex; gap:12px; align-items:center; min-height:92px;
      transition:transform .08s ease, border-color .12s ease, box-shadow .12s ease;
      text-align: left;
    }
    .card-btn:hover{border-color: var(--c-border-active);}
    .card-btn.active{border-color: var(--c-border-active); box-shadow:0 0 0 4px var(--c-ring); transform:translateY(-1px)}
    .card-title{font-weight:700;margin:0 0 4px; color: var(--c-text);}
    .card-sub{color: var(--c-text-muted);font-size:.9rem;margin:0}

    /* Themed defaults used by inline SVGs */
    .card-svg { 
      --body: var(--c-bg-input); 
      --line: var(--c-border-input); 
      --soft: var(--c-bg-panel); 
      --ink: var(--c-text); 
    }

    /* ICON SIZING â€“ unified */
    .card-svg { width: 64px; height: 64px; flex: 0 0 64px; display: grid; place-items: center; }
    .card-svg svg { width: 100%; height: 100%; max-width: 100%; max-height: 100%; }

    .emitter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; }
    .emitter-card { flex-direction: column; text-align: center; padding: 14px 10px; min-height: 120px; justify-content: center; }
    .emitter-card .card-svg { width: 72px; height: 72px; flex: 0 0 72px; margin-bottom: 8px; }

    .small-card { flex-direction: column; text-align: center; padding: 12px 10px; min-height: 110px; justify-content: center; }
    .small-card .card-svg { width: 72px; height: 72px; flex: 0 0 72px; margin-bottom: 6px; }

    /* Slider + Number */
    .slider-wrap{display:grid;grid-template-columns:1fr 110px;gap:12px;align-items:center}
    input[type="range"]{
        -webkit-appearance:none; width:100%; height:8px; border-radius:999px; background: var(--c-border-input); outline:none; margin-top: 8px;
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; width:22px; height:22px; border-radius:50%; background: var(--c-thumb); border:3px solid var(--c-bg-panel); box-shadow:0 2px 6px rgba(0,0,0,.35); cursor:pointer;
    }
    .chip{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--c-border-input);background: var(--c-bg-input);color: var(--c-text-muted);border-radius:999px;padding:6px 10px;font-size:.88rem}

    /* Themed Sliders */
    .comfort-slider::-webkit-slider-thumb { background: #22c55e; }
    .space-slider::-webkit-slider-thumb { background: #a1a1aa; }
    .temp-slider { background: linear-gradient(90deg, #3b82f6,#fde047,#ef4444); }
    .temp-slider::-webkit-slider-thumb { background: var(--c-bg-panel); border-color: var(--c-text-muted); }

    /* Output Section */
    .result{ background: var(--c-bg-panel); border:1px solid var(--c-border); border-radius:14px; padding:16px; }
    .stat-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:680px){ .stat-grid{grid-template-columns:1fr} }
    .stat{ background: var(--c-bg-stat);border:1px solid var(--c-border-stat);border-radius:12px;padding:12px }
    .stat h3{margin:0 0 6px;font-size:1rem;color: var(--c-text-header)}
    .stat .big{font-size:1.6rem;font-weight:800}

    /* Gauge Bar */
    .gauge{position:relative;height:14px;background: var(--c-gauge-bg);border:1px solid var(--c-gauge-border);border-radius:999px;margin-top:8px;overflow:hidden}
    .gauge .fill{position:absolute;left:0;top:0;bottom:0;background:linear-gradient(90deg,#22c55e,#f59e0b,#ef4444);width:0%}
    .gauge .tick{position:absolute;top:-6px;width:2px;height:26px;background: var(--c-gauge-tick);opacity:.9}
    .legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px;color: var(--c-text-muted);font-size:.85rem}
    .legend span{display:inline-flex;align-items:center;gap:6px}
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.ok{background:#22c55e}.dot.mid{background:#f59e0b}.dot.bad{background:#ef4444}
    .divider{height:1px;background: var(--c-border);margin:14px 0}
    .note{color: var(--c-text-muted);font-size:.92rem}
    .btn-primary{ background: var(--c-brand); color:#fff;padding:10px 14px;border-radius:10px;font-weight:700; text-decoration:none; display:inline-flex; align-items:center; gap:8px; border:none; cursor:pointer; }
    .btn-primary:hover{background: var(--c-brand-hover)}
    .footnote{color: var(--c-text-muted);font-size:.85rem}

    /* Theme Toggle Button */
    #themeToggle { background: none; border: 1px solid var(--c-border-input); color: var(--c-text-muted); width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background-color .2s, border-color .2s; }
    #themeToggle:hover { background-color: var(--c-bg-input); border-color: var(--c-border-active); }
    #themeToggle .sun { display: none; }
    html.light-mode #themeToggle .moon { display: none; }
    html.light-mode #themeToggle .sun { display: block; }

    /* Tooltip */
    .tooltip { position: relative; display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; border-radius: 50%; background-color: var(--c-border-input); color: var(--c-text-muted); font-size: 12px; font-weight: bold; cursor: help; }
    .tooltip-text { visibility: hidden; width: 280px; background-color: var(--c-bg-panel); color: var(--c-text); text-align: left; border-radius: 8px; padding: 10px; position: absolute; z-index: 10; bottom: 140%; left: 50%; transform: translateX(-50%); opacity: 0; transition: opacity 0.2s; box-shadow: var(--c-shadow); border: 1px solid var(--c-border); font-size: 0.85rem; font-weight: normal; line-height: 1.5; }
    .tooltip-text::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: var(--c-border) transparent transparent transparent; }
    .tooltip:hover .tooltip-text, .tooltip:focus .tooltip-text { visibility: visible; opacity: 1; }

    /* Label Grouping */
    .label-group { display: flex; align-items: center; gap: 8px; }
    .label > .label-group { margin-right: auto; }

    /* Power Input Group */
    .power-input-group { background-color: var(--c-bg-input); border: 1px solid var(--c-border-input); border-radius: 12px; padding: 10px 14px; }
    .power-input-group .label { margin-bottom: 8px; }
    .power-value-wrapper { display: flex; align-items: center; gap: 8px; background-color: var(--c-bg-panel); border: 1px solid var(--c-border); border-radius: 8px; padding: 2px; }
    .power-input-group #powerNum { border: none; background: transparent; padding: 4px 8px; font-size: 1.1rem; font-weight: 700; text-align: right; width: 80px; color: var(--c-text); }
    .power-input-group #powerNum:focus { box-shadow: none; }
    .power-input-group .chip { border: none; background-color: var(--c-bg-input); }
    .power-input-group .range { width: 100%; margin-top: 4px; }

    @media (max-width:680px){ .panel{padding:20px} }
  </style>
</head>
<body>
  <header>
    <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:16px;">
        <button id="themeToggle" title="Helles/Dunkles Design umschalten" aria-label="Helles/Dunkles Design umschalten">
            <svg class="moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            <svg class="sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
        </button>
    </div>
    <p class="footnote">Finde mit wenigen Angaben die passende Pufferspeicher-GrÃ¶ÃŸe. Alle Werte sind Richtwerte und ersetzen keine individuelle Fachplanung.</p>
  </header>

  <main>
    <!-- INPUTS -->
    <section class="panel" aria-labelledby="inputs">
      <h2 id="inputs">Eingaben</h2>

      <!-- Systemart -->
      <!-- ... (unverÃ¤ndert, wie deine Vorlage) ... -->

      <!-- (DEIN KOMPLETTER INPUT-BEREICH AUS DER VORLAGE BLEIBT HIER â€“ ich habe nur im Output den PDF-Button entfernt) -->

      <!-- HeizflÃ¤chen, Warmwasser, EVU usw. (dein bestehender Code) -->
      <!-- ... der gesamte Eingabeteil aus deiner Nachricht bleibt unverÃ¤ndert ... -->
    </section>

    <!-- OUTPUTS -->
    <section class="panel" aria-labelledby="outputs">
      <h2 id="outputs">Ergebnis</h2>

      <div class="result">
        <div class="stat-grid">
          <div class="stat">
            <h3>Empfohlene GrÃ¶ÃŸe</h3>
            <div class="big" id="resLiters">â€“</div>
          </div>
          <div class="stat">
            <h3>Optimale Spanne</h3>
            <div class="big" id="resRange">â€“</div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="stat">
          <h3>NÃ¤chste StandardgrÃ¶ÃŸe</h3>
          <div class="big" id="resStd">â€“</div>
        </div>

        <div class="divider"></div>

        <!-- Gauge Visualization -->
        <div>
          <div class="label" style="justify-content:flex-start">
            <div class="label-group">
                <span>Volumen pro kW (l/kW) â€“ Einordnung</span>
            </div>
          </div>
          <div class="gauge" aria-label="Einordnung l/kW">
            <div class="fill" id="gaugeFill" style="width:0%"></div>
            <div class="tick" data-mark="20"></div>
            <div class="tick" data-mark="30"></div>
            <div class="tick" data-mark="50"></div>
            <div class="tick" data-mark="80"></div>
          </div>
          <div class="legend">
            <span><span class="dot ok"></span> ~20 l/kW</span>
            <span><span class="dot mid"></span> ~30â€“50 l/kW</span>
            <span><span class="dot bad"></span> â‰¥80 l/kW</span>
          </div>
        </div>

        <div class="divider"></div>

        <p id="resMsg" class="note">â€“</p>
        <p id="resWarn" class="help" style="margin-top:6px">â€“</p>

        <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
          <a class="btn-primary" id="shopBtn" href="#" target="_blank" rel="noopener">Passenden Speicher im Shop anzeigen</a>
          <!-- PDF-Button wurde entfernt -->
        </div>
      </div>
    </section>
  </main>

  <script>
    // ===== Cards =====
    const sysCards     = document.querySelectorAll('#systemCards .card-btn');
    const emitterCards = document.querySelectorAll('#emitterCards .card-btn');
    const dhwCards     = document.querySelectorAll('#dhwCards .card-btn');
    const evuCards     = document.querySelectorAll('#evuCards .card-btn');

    // ===== Inputs =====
    const powerRange = document.getElementById('powerRange');
    const powerNum   = document.getElementById('powerNum');
    const evuHoursWrap = document.getElementById('evuHoursWrap');
    const evuHours   = document.getElementById('evuHours');
    const comfortSlider = document.getElementById('comfortSlider');
    const comfortValueDisplay = document.getElementById('comfortValueDisplay');
    const spaceSlider = document.getElementById('spaceSlider');
    const spaceValueDisplay = document.getElementById('spaceValueDisplay');
    const supplySlider = document.getElementById('supplySlider');
    const supplyValueDisplay = document.getElementById('supplyValueDisplay');

    // ===== Outputs =====
    const resLiters = document.getElementById('resLiters');
    const resRange  = document.getElementById('resRange');
    const resStd    = document.getElementById('resStd');
    const resMsg    = document.getElementById('resMsg');
    const resWarn   = document.getElementById('resWarn');
    const gaugeFill = document.getElementById('gaugeFill');

    // ===== Misc =====
    const shopBtn   = document.getElementById('shopBtn');
    const themeToggle = document.getElementById('themeToggle');

    // --- State ---
    const state = {
      system: 'monovalent',
      power: 10,
      emitters: 'flaeche',
      dhw: 'no',
      evu: 'no',
      evuHours: 2,
      comfort: 10,
      space: 'mid',
      supply: 35
    };

    // --- Helpers ---
    function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }
    function fmt(n){ return Intl.NumberFormat('de-DE').format(Math.round(n)); }
    function fmt10(n){ return Intl.NumberFormat('de-DE').format(Math.round(n/10)*10); }

    const STD = [100,200,300,400,500,600,800,1000];
    const PRODUKTE = {
      100: 'https://www.westech.shop/heizkraft-silo-pss-100-gr-pufferspeicher-100l',
      200: 'https://www.westech.shop/heizkraft-silo-pss-200-gr-pufferspeicher-200l',
      300: 'https://www.westech.shop/heizkraft-silo-pss-300-gr-pufferspeicher-300l',
      400: 'https://www.westech.shop/Pufferspeicher',
      500: 'https://www.westech.shop/heizkraft-silo-pss-500-gr-pufferspeicher-500l',
      600: 'https://www.westech.shop/Pufferspeicher',
      800: 'https://www.westech.shop/heizkraft-silo-ps-800-gr-pufferspeicher-800l-soft-polyurethane',
      1000:'https://www.westech.shop/heizkraft-silo-ps1-1000-gr-pufferspeicher-1000l-pexl-poly'
    };
    const BASE = { mono: 25, bi: 45 };

    function emitterFactor(type){
      if(type==='flaeche') return 0.90;
      if(type==='radiator') return 1.10;
      return 1.00;
    }
    function evuFactor(hours){ return 1 + (0.06 * hours); }
    function comfortFactor(pct){ return 1 + (pct/100); }
    function dhwFactor(val){ return val==='yes' ? 1.12 : 1.00; }
    function supplyHintFactor(temp){
      if(!temp) return 1.00;
      if(temp >= 55) return 1.10;
      if(temp >= 45) return 1.05;
      return 1.00;
    }
    function spaceLimit(space){
      if(space==='small') return 500;
      if(space==='mid') return 800;
      return 1200;
    }
    function nextStandard(vol){
      for(const v of STD){ if(v >= vol) return v; }
      return STD[STD.length-1];
    }
    function produktLink(std){ return PRODUKTE[std] || 'https://www.westech.shop/Pufferspeicher'; }

    // --- Calculation ---
    function calculate(){
      const P = clamp(Number(state.power)||0, 1, 100);
      const base = (state.system==='monovalent') ? BASE.mono : BASE.bi;
      let factor = 1.0;

      factor *= emitterFactor(state.emitters);
      if(state.evu==='yes'){ factor *= evuFactor(Number(state.evuHours)||0); }
      factor *= comfortFactor(Number(state.comfort)||0);
      factor *= dhwFactor(state.dhw);
      factor *= supplyHintFactor(state.supply ? Number(state.supply) : null);

      const l_per_kw = base * factor;
      const V = l_per_kw * P;
      const Vmin = V * 0.92;
      const Vmax = V * 1.08;
      const gaugePct = Math.max(0, Math.min(100, (l_per_kw/100)*100));
      const std = nextStandard(V);

      let msg = `Berechnet auf Basis von ${P.toFixed(1)} kW, Systemart â€ž${state.system}â€œ, HeizflÃ¤chen â€ž${labelEmitters(state.emitters)}â€`;
      if(state.evu==='yes') msg += ` und ${state.evuHours} h EVU-Sperre`;
      if(state.dhw==='yes') msg += ` inkl. Warmwasserbereitung`;
      msg += `.`;

      let warn = '';
      const spaceMax = spaceLimit(state.space);
      if( (V/P) >= 80 ) warn += 'âš ï¸ Sehr hohes l/kW-VerhÃ¤ltnis (â‰¥80). PrÃ¼fe Bereitschaftsverluste, DÃ¤mmung und Regelstrategie. ';
      if( std > spaceMax ) warn += `ðŸ“ Platzgrenze Ã¼berschritten (gewÃ¤hlt: ${state.space}). PrÃ¼fe Aufstellbedingungen oder kleinere Range. `;

      resLiters.textContent = `${fmt(V)} Liter (${Math.round(l_per_kw)} l/kW)`;
      resRange.textContent  = `${fmt10(Vmin)}â€“${fmt10(Vmax)} Liter`;
      resStd.textContent    = `${fmt(std)} Liter`;
      gaugeFill.style.width = `${gaugePct}%`;
      resMsg.textContent    = msg;
      resWarn.textContent   = warn || ' ';

      shopBtn.href = produktLink(std);

      // update tick positions based on marks 20/30/50/80 (scale 0..100)
      document.querySelectorAll('.gauge .tick').forEach(t => {
        const mark = Number(t.getAttribute('data-mark')) || 0;
        const pos = Math.max(0, Math.min(100, (mark/100)*100));
        t.style.left = pos + '%';
      });
    }

    function labelEmitters(val){
      if(val==='flaeche') return 'FlÃ¤chenheizung';
      if(val==='radiator') return 'HeizkÃ¶rper';
      return 'Mischsystem';
    }

    // --- Event Listeners ---
    function setupCardSelection(cards, stateKey) {
      cards.forEach(btn => {
        btn.addEventListener('click', () => {
          cards.forEach(b => { b.classList.remove('active'); b.setAttribute('aria-selected','false'); b.setAttribute('aria-pressed','false'); });
          btn.classList.add('active');
          btn.setAttribute('aria-selected','true');
          btn.setAttribute('aria-pressed','true');
          state[stateKey] = btn.dataset.value;
          if (stateKey === 'evu') evuHoursWrap.style.display = (state.evu === 'yes') ? 'block' : 'none';
          calculate();
        });
      });
    }

    function setupEventListeners() {
      setupCardSelection(sysCards, 'system');
      setupCardSelection(emitterCards, 'emitters');
      setupCardSelection(dhwCards, 'dhw');
      setupCardSelection(evuCards, 'evu');

      powerRange.addEventListener('input', ()=>{ powerNum.value = Number(powerRange.value); state.power = Number(powerRange.value); calculate(); });
      powerNum.addEventListener('input', ()=>{ const v = clamp(Number(powerNum.value)||0, 1, 100); powerRange.value = v; state.power = v; calculate(); });
      evuHours.addEventListener('input', ()=>{ state.evuHours = clamp(Number(evuHours.value)||0, 0, 12); calculate(); });

      comfortSlider.addEventListener('input', () => { const vals=[0,10,20]; const labels=['Minimal (0%)','Mittel (+10%)','Hoch (+20%)']; state.comfort = vals[comfortSlider.value]; comfortValueDisplay.textContent = labels[comfortSlider.value]; calculate(); });
      spaceSlider.addEventListener('input', () => { const vals=['small','mid','large']; const labels=['Klein (â‰¤ 500 l)','Mittel (â‰¤ 800 l)','GroÃŸ (â‰¥ 1000 l)']; state.space = vals[spaceSlider.value]; spaceValueDisplay.textContent = labels[spaceSlider.value]; calculate(); });
      supplySlider.addEventListener('input', () => { const v = Number(supplySlider.value); state.supply = v; supplyValueDisplay.textContent = `${v} Â°C`; calculate(); });
    }

    // --- Theme Switcher ---
    function applyTheme(theme) { if (theme === 'light') document.documentElement.classList.add('light-mode'); else document.documentElement.classList.remove('light-mode'); localStorage.setItem('theme', theme); }
    themeToggle.addEventListener('click', () => { const newTheme = document.documentElement.classList.contains('light-mode') ? 'dark' : 'light'; applyTheme(newTheme); });

    // --- Init ---
    function init() {
      const savedTheme = localStorage.getItem('theme');
      const currentTheme = savedTheme || 'light';
      applyTheme(currentTheme);
      setupEventListeners();
      calculate();
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
