<!-- =========================================
     Compact Solution Tree â€“ HochdruckstÃ¶rung WÃ¤rmepumpe
     Drop-in fÃ¼r JTL Blog (HTML + Vanilla JS, ohne externe AbhÃ¤ngigkeiten)
     ========================================= -->
<div id="hp-compact-frame" style="max-width: 560px; border: 2px solid #1e70bf; border-radius: 14px; padding: 16px; background: #f9fbfd; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;">
  <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
    <div id="hp-step-title" style="font-weight:700; font-size:18px; line-height:1.2;">HochdruckstÃ¶rung â€“ Assistent</div>
    <div style="font-size:12px; color:#5b7083;"><span id="hp-step-index">1</span>/<span id="hp-step-total">9</span></div>
  </div>

  <!-- Fortschrittsbalken -->
  <div style="height:6px; background:#dde9f8; border-radius:999px; overflow:hidden; margin-bottom:14px;">
    <div id="hp-progress" style="height:100%; width:0%; background:#1e70bf;"></div>
  </div>

  <!-- Inhalt -->
  <div id="hp-step-content" style="min-height: 230px; font-size:15px; line-height:1.55;">
    <!-- Wird per JS gefÃ¼llt -->
    <noscript>Bitte JavaScript aktivieren, um den Assistenten zu nutzen.</noscript>
  </div>

  <!-- CTA-Zeile -->
  <div style="display:flex; gap:8px; justify-content:center; margin-top:14px;">
    <button id="hp-prev" type="button" style="padding:8px 12px; border-radius:8px; border:1px solid #d0d7de; background:#fff; cursor:pointer;">â¬…ï¸ ZurÃ¼ck</button>
    <button id="hp-next" type="button" style="padding:8px 12px; border-radius:8px; border:0; background:#1e70bf; color:#fff; cursor:pointer;">Weiter â¡ï¸</button>
    <button id="hp-done" type="button" style="padding:8px 12px; border-radius:8px; border:0; background:#0f7a3a; color:#fff; display:none; cursor:pointer;">âœ… Problem beseitigt!</button>
  </div>

  <!-- Hinweis -->
  <div style="margin-top:10px; font-size:12px; color:#5b7083; text-align:center;">
    Tipp: Nach jedem Schritt quittieren und kurz testen. Kommt die StÃ¶rung wieder, gehe weiter.
  </div>
</div>

<script>
(function(){
  const steps = [
    {
      title: "ğŸš¦ Start â€“ Meldung â€Hochdruckâ€œ",
      html: `
        <p>Die WÃ¤rmepumpe hat aus SicherheitsgrÃ¼nden abgeschaltet. Quittiere die StÃ¶rung und beobachte das Verhalten.</p>
        <ul>
          <li><strong>Einmalig nach Stromausfall?</strong> Kurz beobachten. Bei Wiederholung â†’ weiter.</li>
          <li><strong>Kommt die Meldung sofort wieder?</strong> Starte mit Schritt 1.</li>
        </ul>
        <p><em>Ziel:</em> WÃ¤rmestau am VerflÃ¼ssiger vermeiden, damit der Druck nicht an die obere Grenze lÃ¤uft.</p>
      `
    },
    {
      title: "ğŸ’§ Schritt 1 â€“ Heizungsdruck & Luft",
      html: `
        <p><strong>PrÃ¼fen:</strong> Liegt der <strong>Anlagendruck (kalt)</strong> bei ca. <strong>1,5â€“1,8 bar</strong>? Ist die Anlage entlÃ¼ftet? Membran-AusdehnungsgefÃ¤ÃŸ (MAG) plausibel?</p>
        <ul>
          <li>âœ… <strong>Ja:</strong> Weiter zu Schritt 2.</li>
          <li>â— <strong>Nein:</strong> Wasser nachfÃ¼llen, sauber entlÃ¼ften, MAG prÃ¼fen â†’ dann erneut testen.</li>
        </ul>
        <p><em>Warum?</em> Zu wenig Wasser â‡’ zu geringer Durchfluss â‡’ WÃ¤rmestau am VerflÃ¼ssiger â‡’ Hochdruck.</p>
      `
    },
    {
      title: "ğŸ” Schritt 2 â€“ Durchfluss (Volumenstrom)",
      html: `
        <p><strong>Checkliste Durchfluss:</strong></p>
        <ul>
          <li>Alle <strong>Thermostatventile</strong> und <strong>Zonen</strong> offen?</li>
          <li><strong>Pumpenstufe</strong> nicht zu niedrig? <strong>Mischer/Absperrungen</strong> korrekt?</li>
          <li><strong>Î”T (Vorlaufâ€“RÃ¼cklauf)</strong> im Heizbetrieb â‰¤ <strong>5â€“7 K</strong>?</li>
        </ul>
        <p><strong>Richtwert-Formel:</strong> <code>VÌ‡ (mÂ³/h) â‰ˆ 0,86 Ã— Leistung (kW) Ã· Î”T (K)</code><br>
        Beispiel: 10&nbsp;kW, Î”T=5&nbsp;K â‡’ <strong>â‰ˆ1,72&nbsp;mÂ³/h</strong>.</p>
        <ul>
          <li>âœ… Î”T â‰¤ 7 K â†’ Weiter zu Schritt 3.</li>
          <li>âš ï¸ Î”T &gt; 7 K â†’ Durchfluss erhÃ¶hen, hydraulischen Abgleich prÃ¼fen; dann testen.</li>
        </ul>
      `
    },
    {
      title: "ğŸ§¼ Schritt 3 â€“ Filter & WÃ¤rmetauscher",
      html: `
        <p><strong>Reinigen & prÃ¼fen:</strong></p>
        <ul>
          <li><strong>SchmutzfÃ¤nger/Magnetfilter</strong> sÃ¤ubern (Magnetit/Schlamm entfernen).</li>
          <li><strong>PlattenwÃ¤rmetauscher</strong> (Heizung/WW) auf Verschlammung/Kalk prÃ¼fen; bei Bedarf spÃ¼len/chemisch reinigen.</li>
        </ul>
        <ul>
          <li>ğŸ§½ <strong>Verschmutzt:</strong> Reinigen â†’ Test.</li>
          <li>âœ… <strong>Sauber:</strong> Weiter zu Schritt 4.</li>
        </ul>
      `
    },
    {
      title: "ğŸŒ¬ï¸ Schritt 4 â€“ Luftseite (nur Luft/Wasserâ€‘WP)",
      html: `
        <p><strong>Freie LuftfÃ¼hrung sicherstellen:</strong></p>
        <ul>
          <li>Lamellen frei von Laub/Flusen/Staub?</li>
          <li>Einhalte der <strong>MindestabstÃ¤nde</strong> rund ums GerÃ¤t?</li>
          <li>Keine <strong>Einhausung</strong> ohne geprÃ¼fte LuftfÃ¼hrung?</li>
          <li><strong>LÃ¼fter</strong> lÃ¤uft ruhig und mit Drehzahl?</li>
        </ul>
        <ul>
          <li>ğŸ§¹ <strong>Problem gefunden:</strong> reinigen/freilegen/instandsetzen â†’ Test.</li>
          <li>âœ… <strong>Alles ok:</strong> Weiter zu Schritt 5.</li>
        </ul>
      `
    },
    {
      title: "âš™ï¸ Schritt 5 â€“ Einstellungen (Regelung)",
      html: `
        <p><strong>Regler prÃ¼fen:</strong></p>
        <ul>
          <li><strong>Heizkurve</strong> zu steil? (Testweise etwas abflachen.)</li>
          <li><strong>Warmwasser-Soll</strong> sehr hoch (&gt;55â€“60&nbsp;Â°C)? (Probeweise senken.)</li>
          <li>PrioritÃ¤ten/Grenzwerte plausibel? (z.â€¯B. WW-PrioritÃ¤t, Sperrzeiten)</li>
        </ul>
        <ul>
          <li>ğŸ§¯ <strong>Angepasst:</strong> Verhalten beobachten â†’ Wenn StÃ¶rung wiederkehrt â†’ Schritt 6.</li>
          <li>âœ… <strong>Schon plausibel:</strong> Weiter zu Schritt 6.</li>
        </ul>
      `
    },
    {
      title: "ğŸ§ª Schritt 6 â€“ Sensorik & Ventile",
      html: `
        <p><strong>Komponenten checken:</strong></p>
        <ul>
          <li><strong>Durchflusssensor</strong> vorhanden/funktioniert? Anzeigen plausibel?</li>
          <li><strong>TemperaturfÃ¼hler</strong> korrekt montiert (Kontakt, Position)?</li>
          <li><strong>Zonenventile</strong> Ã¶ffnen sicher, <strong>RÃ¼ckschlagventile</strong> nicht verklemmt?</li>
        </ul>
        <ul>
          <li>ğŸ› ï¸ <strong>AuffÃ¤lligkeiten:</strong> instandsetzen/ersetzen â†’ Test.</li>
          <li>âœ… <strong>Keine AuffÃ¤lligkeiten:</strong> Weiter zu Schritt 7.</li>
        </ul>
      `
    },
    {
      title: "ğŸ Schritt 7 â€“ Warmwasser-Spezialfall",
      html: `
        <p><strong>Tritt die StÃ¶rung vorwiegend im Warmwasserbetrieb auf?</strong></p>
        <ul>
          <li><strong>WW-PlattenwÃ¤rmetauscher</strong> auf Kalk/Fouling prÃ¼fen, ggf. entkalken.</li>
          <li><strong>Î”T/Volumenstrom</strong> im WW-Kreis prÃ¼fen (Mindestdurchfluss sicherstellen).</li>
          <li><strong>PrioritÃ¤ten/Schaltzeiten</strong> plausibel (keine unnÃ¶tigen Spitzen)?</li>
        </ul>
        <p>Wenn trotz Optimierung weiter HPâ€‘StÃ¶rungen auftreten â†’ nÃ¤chster Schritt.</p>
      `
    },
    {
      title: "ğŸ‘¨â€ğŸ”§ Schritt 8 â€“ Fachbetrieb / KÃ¤ltekreis",
      html: `
        <p><strong>Nur durch zertifizierte KÃ¤ltetechniker:</strong></p>
        <ul>
          <li><strong>Kondensationsdruck</strong> und <strong>Hochdruckgrenze</strong> gegentesten</li>
          <li><strong>Subcooling/Superheat</strong> bewerten</li>
          <li><strong>VerflÃ¼ssigerzustand</strong> & KÃ¤ltemittelfÃ¼llmenge prÃ¼fen</li>
        </ul>
        <p><em>Wichtig:</em> Keine Eigenarbeiten am KÃ¤ltekreis.</p>
      `
    },
    {
      title: "ğŸ¯ Ergebnis & PrÃ¤vention",
      html: `
        <ul>
          <li>âœ… <strong>StÃ¶rung behoben:</strong> Normalbetrieb & Monitoring (Î”T, Durchfluss, Filterzustand).</li>
          <li>ğŸ§­ <strong>Teilerfolg:</strong> Heizkurve/WWâ€‘Soll/Pumpenstufe weiter feinjustieren.</li>
          <li>ğŸš‘ <strong>Keine Besserung:</strong> Serviceauftrag an Fachbetrieb auslÃ¶sen.</li>
        </ul>
        <p><strong>PrÃ¤vention:</strong> saubere Hydraulik, regelmÃ¤ÃŸige Filterreinigung, passende Heizkurve, ausreichender Volumenstrom.</p>
      `
    }
  ];

  // DOM
  const frame = document.getElementById('hp-compact-frame');
  const titleEl = document.getElementById('hp-step-title');
  const contentEl = document.getElementById('hp-step-content');
  const prevBtn = document.getElementById('hp-prev');
  const nextBtn = document.getElementById('hp-next');
  const doneBtn = document.getElementById('hp-done');
  const idxEl = document.getElementById('hp-step-index');
  const totalEl = document.getElementById('hp-step-total');
  const progressEl = document.getElementById('hp-progress');

  let i = 0;
  totalEl.textContent = steps.length.toString();

  function render(){
    const s = steps[i];
    titleEl.textContent = s.title;
    contentEl.innerHTML = s.html;
    idxEl.textContent = (i+1).toString();

    // Buttons
    prevBtn.style.display = i === 0 ? 'none' : 'inline-block';
    nextBtn.style.display = i >= steps.length - 1 ? 'none' : 'inline-block';
    doneBtn.style.display = i >= steps.length - 1 ? 'inline-block' : 'none';

    // Progress
    const p = ((i) / (steps.length - 1)) * 100;
    progressEl.style.width = (isFinite(p) ? p : 0) + '%';
  }

  prevBtn.addEventListener('click', function(){ if(i>0){ i--; render(); }});
  nextBtn.addEventListener('click', function(){ if(i<steps.length-1){ i++; render(); }});
  doneBtn.addEventListener('click', function(){
    titleEl.textContent = 'ğŸ‰ GlÃ¼ckwunsch!';
    contentEl.innerHTML = '<p>Die HochdruckstÃ¶rung scheint behoben zu sein. Behalte Î”T, Durchfluss und Filter im Blick und plane regelmÃ¤ÃŸige Wartungen ein.</p>';
    prevBtn.style.display = 'none';
    nextBtn.style.display = 'none';
    doneBtn.style.display = 'none';
    progressEl.style.width = '100%';
    idxEl.textContent = steps.length.toString();
  });

  render();
})();
</script>
